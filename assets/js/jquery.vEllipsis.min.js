!function(t){t.fn.vEllipsis=function(i){function a(t){var i=t.offset().top,a=i+t.height();return h>=a&&i>=c}function e(i,a){function e(){if(i.text(l),c&&i.append(" ",c),h){var a=t(document.createElement("a")).append(h);a.on("click",function(){n(i)}),i.append(" ",a)}}if((!a.expandLink||i.data("expanded")!==!0)&&i.is(":visible")){var l;if(i.data("lastHeight")&&i.data("lastHeight")===i.height()&&i.data("lastWidth")===i.width()&&(i.data("lastText")===i.text()||i.data("lastHTML")===i.html()))return;i.data("originalText")?(l=i.data("originalText"),i.text(l)):(l=i.text(),i.data("originalText",l),i.data("originalHTML",i.html()));var o,s=i.attr("class").split(/\s+/),d=a.lines,r=new RegExp("^"+a.linesClass+"-(\\d+)$");if(t.each(s,function(t,i){o=i.match(r),null!==o&&(d=Number(o[1]))}),a.additionalEnding&&i.data("link"))var c=i.data("link");if(a.expandLink&&i.data("expandlink"))var h=i.data("expandlink");if(1>d)l="",i.text("");else{var p=l,u=p.length,g=i.height();i.text("a");var m=parseFloat(i.css("lineHeight"),10),v=i.height(),f=m>v?m-v:0,w=f*(d-1)+v*d;if(w>=g)return i.text(l),i.data("lastText",l),i.data("lastHeight",i.height()),void i.data("lastWidth",i.width());var x=(w+v)/(g-(v+f));x>1&&(x=1);var T=Math.ceil(x*u);l=l.slice(0,T);var E=a["char"];c&&(i.html(c),E+=" "+i.text()),h&&(i.html(h),E+=" "+i.text());for(var k=1===d?0:Math.ceil(T/2),H=0,L=T-1;k+a.tolerance-1<L;)H=Math.ceil((k+L)/2),i.text(l.slice(0,H)+E),i.height()<=w?k=H:L=H-a.tolerance;l=l.slice(0,k),a.onlyFullWords&&(l=l.replace(/\s([^\s.]+)$/,"")),l=l.replace(/([:.,\s]+$)/g,""),l+=a["char"]}if(0!=a.animationTime&&i.data("collapsing")){var M=i.outerHeight();i.html(i.data("originalHTML")).css("height",i.outerHeight()).animate({height:M},parseInt(a.animationTime),function(){i.css("height",""),e()})}else e();i.data("lastText",l),i.data("lastHTML",i.html()),i.data("lastHeight",i.height()),i.data("lastWidth",i.width()),a.callback.call(i[0])}}function n(a){if(0!=i.animationTime)var e=a.outerHeight();if(a.html(a.data("originalHTML")),0!=i.animationTime){var n=a.outerHeight();a.css("height",e).animate({height:n},parseInt(i.animationTime),function(){a.css("height","")})}if(i.expandLink&&a.data("collapselink")){var o=a.data("collapselink"),s=t(document.createElement("a")).append(o);s.on("click",function(){l(a)}),a.append(" ",s),a.data("expanded",!0)}}function l(t){t.removeData("expanded").data("collapsing",!0),e(t,i),t.removeData("collapsing")}function o(n){c=t(window).scrollTop(),h=c+t(window).height(),t(i.element).each(function(){var n=t(this);a(n)&&e(n,i)})}function s(){clearTimeout(d),d=setTimeout(function(){o()},i.delay)}if(window.vEllipsis)return window.vEllipsis.options=t.extend(window.vEllipsis.options,i),void t(document).trigger("vEllipsisCreate");window.vEllipsis={},window.vEllipsis.options={element:".v-ellipsis",lines:1,onlyFullWords:!1,"char":"...",callback:function(){},responsive:!1,tolerance:5,delay:300,elementEvent:"change",additionalEnding:!1,expandLink:!1,collapseLink:!1,animationTime:"0",linesClass:"v-ellipsis-lines"},t(document).on("vEllipsisCreate",function(){o()});var d,r,i,c=t(window).scrollTop(),h=c+t(window).height();return window.vEllipsis.options=i=t.extend(window.vEllipsis.options,i),i.tolerance<1&&(i.tolerance=1),i.responsive&&t(window).resize(function(){s()}),t(window).on("scroll",function(){clearTimeout(r),r=setTimeout(function(){o()},100)}),t(document).on(i.elementEvent,i.element,function(){var a=t(this);a.data("originalText",a.text()),a.data("originalHTML",a.html()),e(a,i)}),o(),this}}(jQuery);
